AnyBackup5.0.2.0到5.0.3.0升级指导文档版权声明版权所有©2003—2015爱数软件有限公司未经本公司许可，任何单位或个人不得以任何形式，复制、传播、摘抄本文档内容的部分或全部。本文档内容上可能会有增删和修改，爱数软件有限公司会定期将修订后的内容纳入新版本中，如有更改恕不另行通知。关于爱数爱数是中国领先的数据管理解决方案提供商，整体数据管理业务已经遍及全球市场。爱数的数据管理解决方案着眼于企业最核心的资产：数据，并从业务连续性、数据存储、数据保护、非结构化数据管理及数据长期保存五个维度出发，帮助客户解决云化数据中心基础设施层的数据管理需求。在云计算、虚拟化以及BYOD和移动互联四大趋势下，随着IT即服务的目标明朗化，客户的整体建设需求也在顺势而为变的更加关注数据管理服务：高性能可弹性扩展且池化管理的存储多重高效的数据保护方式足够开放和安全的非结构化数据管理我们立足于趋势前沿，紧贴行业市场需求，针对不同的客户定位，基于专业沉淀的技术，通过持续创新产品，提供专业的数据管理解决方案和服务，致力于通过高效的数据管理来帮助用户提升运营效率，并加固业务连续性，其中爱数专业的存储产品AnyStorage助客户解决数据高效存储、数据可用性、数据长期保存的难题；爱数卓越的备份一体机，从超易备到AnyBackup再到TxCloud，提供前端到后端的全面强大的数据安全保障服务，采用多种保护模式从多个维度满足客户数据保护的需求；爱数创新的非结构化数据管理产品AnyShare和易享云，助力客户在新趋势下提升和优化非结构化数据管理效率；爱数增值型云产品基于Tx统一运营管理平台，可助力客户轻松实现共享灾备云和共享文档云，即以SaaS模式提供备份即服务和文档即服务。借助爱数的方案和产品，我们的客户可以从容布局云端，赋予IT战略价值，实现从数据资产到信息资产的跨越，有效提升业务效率。作为备份一体机的首创者和引领者，在IDC2013年关于中国备份一体机市场的研究报告中，爱数以18.5%的市场份额位居中国品牌第一。同年，爱数凭借完整的数据管理解决方案入选GartnerCoolVendor名单。源于优秀的企业运营理念和价值观，包括客户为先、平等尊重、兑现承诺、持续变革、追求卓越，我们一直专注于全球智能数据管理典范企业的愿景践行，致力于为全球各地的客户实现无法想象的IT商业价值。如今，爱数的产品和解决方案已经成功服务于全球上万客户，遍及党政、医卫、涉密、教育、企业以及云服务领域等行业，我们将持续用推动业务转型的革命性创新来成就客户发展，帮助客户迎合行业趋势，驾驭数据未来。目录2版权声明3关于爱数6第一章AnyBackup5.0.2.0升级说明61.1AnyBackup5.0.2.0升级说明7第二章基本配置信息72.1可支持升级的产品8第三章升级步骤83.1升级准备83.2更新过程说明93.3客户端升级步骤123.4存储柜/企业版软件控制台升级步骤18FAQ升级指导声明本文档内容包含爱数备份存储柜、爱数备份软件从5.0.2.0到5.0.3.0的升级；必须严格按照升级步骤升级，不允许更改升级步骤顺序。第一章AnyBackup5.0.2.0升级说明1.1AnyBackup5.0.2.0升级说明对于存储柜而言，该升级是指由5.0.2.0.2668到5.0.3.0.398的升级；对于企业版软件而言，该升级是指5.0.2.0.329到5.0.3.0.394的升级；对于客户端而言，该升级是指5.0.2.0.2790到5.0.3.0.3297的升级；升级前请检查是否满足升级要求，具体要求请见第三章升级准备。第二章基本配置信息2.1可支持升级的产品	产品	升级前的软件版本	升级后的软件版本	位数	是否支持升级到5.0.3.0	升级后数据是否可用	软件版控制台	5.0.2.0.329	5.0.3.0.394	64	是	是	存储柜控制台	5.0.2.0.2668	5.0.3.0.398	64	是	是	Windows客户端	5.0.2.0.2790	5.0.3.0.3297	32	是	是	Windows客户端	5.0.2.0.2790	5.0.3.0.3297	64	是	是	Linux客户端	5.0.2.0.2790	5.0.3.0.3297	32	是	是	Linux客户端	5.0.2.0.2790	5.0.3.0.3297	64	是	是第三章升级步骤3.1升级准备更新条件检查：存储柜控制台版本要求：5.0.2.0.2668企业版软件控制台版本要求：5.0.2.0.329客户端版本要求：5.0.2.0.2790软件版控制台上的MySQL版本要求：5.6.19存储柜操作系统要求：EisooEOSServerEdition3.10.1622:00:54@2014-03-31(REV:23234)2、更新包准备从AnyShare里获取对应的更新升级包即可。路径：\AnyShare\产品发布库\备份容灾业务部\AnyBackupFamily\AnyBackup5.0.3.0（2014.12.31）\5.0.2版本升级5.0.3版本更新包3、更新包检查请检查更新包是否是如下名称的更新包：存储柜控制台更新包名称为：AnyBackup-Console-UPDATE-5.0.3.0.398.eup企业版软件控制台更新包名称为：AnyBackup-Soft-UPDATE-5.0.3.0.394.eupWindows32位客户端更新包名称为：AnyBackup-Windows-32-UPDATE-5.0.3.0.3297.eupWindows64位客户端更新包名称为：AnyBackup-Windows-64-UPDATE-5.0.3.0.3297.eupLinux32位客户端更新包名称为：AnyBackup-RedHat-32-UPDATE-5.0.3.0.3297.eupLinux64位客户端更新包名称为：AnyBackup-RedHat-64-UPDATE-5.0.3.0.3297.eup4、检查控制台上是否有定时、实时或远程复制任务在运行，如果有，请停止相关的备份恢复任务，同理，远程复制任务也必须停止掉。5、必须先升级客户端再升级控制台。（如果不按此顺序可能会更新失败，见FAQ11）3.2更新过程说明更新过程，可用如下流程图说明：启动更新程序------>检查更新包----->解压缩更新包----->停止控制台相关服务------->备份替换前的文件------->启动控制台相关服务-----更新成功，退出更新程序。此流程图也适用于客户端更新，不过更新过程中停止/启动的是客户端服务。3.3客户端升级步骤这里以Windows32位客户端为例。1、导入更新包，进入【更新管理】-【导入】，弹出选择更新包的选项，选择对应的更新包即可，如图所示：2、点击确定，即开始导入更新包，大概需要1分钟左右，如图所示：3、导入成功后，则可以看到更新包，如图所示：注意：导入成功后如果没有看到更新包，需刷新下页面即可看到更新包。4、选中更新包，点击更新，如图所示：如果该更新包可以更新合适的客户端，则可以看到被更新的对象，反之，则无法看到被更新的对象，如图所示：点击确定即可，如图所示，进入【更新管理】-【选择更新包】-【更新记录】，可看到客户端正在处于更新中更新时间稍长，请耐心等待，一般需要1分钟左右，期间不要关闭浏览器页面。6、更新完成后，会提示更新成功，且在更新包管理那里，显示绿色的100%，如图所示：也可在更新记录里看到具体的更新记录，如图所示：此时，升级完成，需要做如下检查，来判断是否更新成功，检查项如下：【1】更新记录里的信息是否正确如更新后的版本；【2】进入【客户端管理】，选中客户端，查看版本是否跟【1】中的一致；【2】进入【客户端管理】，查看客户端是否在线。3.4存储柜/企业版软件控制台升级步骤这里以存储柜控制台为例。1、导入更新包，进入【更新管理】-【导入】，弹出选择更新包的选项，选择对应的更新包即可，如图所示：2、点击确定，即开始导入更新包，大概需要1分钟左右，如图所示：3、导入成功后，则可以看到更新包，如图所示：注意：导入成功后如果没有看到更新包，需刷新下页面即可看到更新包。4、选中更新包，点击更新，如图所示：如果该更新包可以更新控制台，则可以看到被更新的对象，反之，则无法看到被更新的对象，如图所示：点击确定即可，控制台正在处于更新中，如图所示：更新时间稍长，请耐心等待，一般需要10分钟左右，期间不要关闭浏览器页面。注意：若当前控制台存在正在执行的任务，必须先停止任务再进行更新。6、更新完成后，会自动退出重新进入登录界面，此时必须清空下缓存，然后登录控制台，如图所示：此时，升级完成，升级完成后需要检查下是否升级成功，具体检查项如下：【1】控制台版本；【2】备份数据是否可用；【3】许可证管理的授权信息是否正确。注意事项：对于企业版软件而言，由于5.0.3对卷做了优化，自备份卷的位置发生变化，需要在后台删除5.0.2残余的自备份卷目录，并且在web上新建自备份卷，否则会导致自备份失败，提示“自备份卷不存在”。具体操作如下：删除残余的自备份卷目录,如图所示：上图中console_self_backup_packages目录做了软链接，需要删除链接文件和源文件。即rm-rf/volumee/console_self_packages;rm-rf/sysvol/node/console_self_backup_packages（2）新建自备份卷，进入【设备管理】-【介质服务器管理】-【介质管理】,如图所示：FAQ1.导入更新包后，页面看不到更新包原因：web服务器延迟，需要一定时间更新页面内容。解决方法：刷新页面即可。2.更新包的格式有何要求更新包格式须为eup格式，且必须真实存在更新包，如果是将其他文件的后缀名改为eup格式，在导入的时候系统会判断出来，提示错误的。3.更新控制台完成后，登录界面出现英文原因：浏览器保留着老版本的cache信息。登录控制台时，浏览器要向nginx服务器发http请求，以便获取界面信息。此时会优先读取cache缓存，如果有，则不再向nginx服务器发请求，而是直接从cache中返回结果。因此获取的控制台信息与新的控制台不一致。解决方法：清空浏览器缓存即可。4.客户端更新到5.0.3.0后，手动卸掉客户端再次安装后，实时备份任务报错，如图:原因：升级后的客户端安装目录下app/bin/components下存在残余文件nccdpmanager_wow64.dll文件。解决方法：卸载客户端后，手动删除安装目录，然后重启机器，重新安装客户端即可。5.升级到5.0.3.0，恢复系统备份数据需要注意哪些内容（1）升级前备份的数据做引导恢复，必须用5.0.2.0的系统恢复环境；（2）升级后备份的数据做引导恢复，必须用5.0.3.0的系统恢复环境。6.升级到5.0.3.0，原有Oracle备份任务编辑浏览数据源时报错，提示“实例未授权，无法创建任务”，如图所示：原因：数据源持久化存储了，上一版本均采用小写记录到数据库中，而这版本已区分大小写，导致和原来小写数据源数据不匹配。产生的影响：仅仅对备份任务编辑有影响，备份恢复无影响。7.升级后Sybase、DB2、Domino的Linux客户端服务名没有改原因：升级后客户端服务名应该为AnyBackupClient，但是由于Linux的Domino、Sybase、DB2客户端进程是非root用户启动的，所以导致在/etc/init.d下无权限更改服务名。但是并不影响备份任务，Domino、Sybase重启客户端服务即可继续备份恢复成功。8.Domino和Sybase的Linux客户端升级后直接备份会抛错失败原因：启动AnyBackupClientServer服务时没有动态加载客户端数据库的lib库文件，导致数据源展不开。解决方法：重启客户端服务，即可备份恢复成功。9.Windows客户端升级后控制面板中的版本号没变控制面板中的路径：开始->控制面板->卸载程序原因：控制面板中的此属性改不了，不影响使用。10.升级后原有的重删任务属性变为：”重复数据删除数据分块大小范围:显示为4~3KB”原因：这里显示为4~3KB，实际就是3~4KB，只是显示问题，备份恢复正常，不影响使用。11.Linux客户端升级失败，提示无法找到文件，获取更新包失败，或者发送消息出现异常原因：此现象是由先更新控制台，后更新客户端的操作导致的。由于控制台更新到5.0.3.0后有部分消息格式被更新，此时更新客户端，会造成5.0.3.0的控制台与5.0.2.0的客户端版本不兼容，导致客户端更新失败。解决办法：先更新客户端再更新控制台，可以规避此问题。如果控制台已经升级，则需要将更新失败的客户端卸载，重新安装5.0.3.0的客户端。（5.0.3.0的客户端可以在控制台登录界面的客户端下载链接中下载）。12.升级后控制台没有DDCache卷或删除DDCache卷，再去备份重删任务，导致控制台介质服务挂掉，任务备份出错解决办法：重启介质服务器，新建DDCache卷即可，不允许没有DDCache卷时备份重删任务。13.升级后，Oracle定时备份任务高级恢复数据文件，可能会出现卡死现象（升级前或升级后的数据都有可能）解决办法：重启客户端服务，再次恢复即可成功。地　　址：上海市联航路1188号浦江智谷8号楼2层邮　　编：201112咨询热线：021-54222601服务热线：400-880-1569官方主页：http://www.eisoo.com微博主页：http://e.weibo.com/eisoosoftware